<div class="p-6">
  <div class="sm:flex sm:justify-between sm:items-center">
    <!-- Left: Title -->
    <div class="mb-4 sm:mb-0 py-5">
      <h1 class="text-xl md:text-3xl text-slate-800 text-white font-bold">
        Data Operasional
      </h1>
    </div>
  </div>
  <!-- Tombol Aksi -->
  <div class="flex justify-between items-center mb-4 rounded-full">
    <a
    href="/operasional/add"
    class="bg-white text-black px-4 py-2 rounded-full flex items-center"
  >
    <span>Tambah Data</span>
    <svg
      xmlns="http://www.w3.org/2000/svg"
      class="h-5 w-5 ml-2"
      viewBox="0 0 20 20"
      fill="currentColor"
    >
      <path
        fill-rule="evenodd"
        d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z"
        clip-rule="evenodd"
      />
    </svg>
  </a>
    </button>

    <div class="flex items-center space-x-2">
      <!-- Search bar -->
      <div class="relative">
        <input
          type="text"
          placeholder="Search..."
          class="bg-white px-4 py-2 rounded-full text-black focus:outline-none"
        />
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-4.35-4.35M4.75 11a7 7 0 1114 0 7 7 0 01-14 0z"
          />
        </svg>
      </div>
    </div>
  </div>

  <!-- Tabel -->
 <div class="overflow-x-auto">
  <table class="min-w-full bg-white rounded-md w-full shadow-lg">
    <thead>
      <tr>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Id Oper</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Nama Oper</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Tgl Trans</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Debet</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Kredit</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Pegawai</th>
        <th class="py-3 px-6 bg-gray-100 text-left font-semibold text-sm text-gray-600">Aksi</th>
      </tr>
    </thead>
    <tbody>
      <% if(allOp.length > 0) { %> <% allOp.forEach((o, index) => { %>
      <tr class="hover:bg-gray-50">
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.kode %></td>
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.nama_oper %></td>
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.tgl_transaksi %></td>
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.debet %></td>
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.kredit %></td>
        <td class="py-4 px-6 text-sm text-gray-700"><%= o.nama_pegawai %></td>
        <td class="py-4 px-6 flex space-x-2">
        <a href="/operasional/edit/<%= o.operasional_id %>" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold rounded-md px-4 py-2 text-xs">Ubah Data</a>
        <button type="button"
        class="bg-red-500 hover:bg-red-600 text-white font-semibold rounded-md px-4 py-2 text-xs" 
        onclick="confirmDelete('<%= o.operasional_id %>')">
        Hapus
        </button>
        </td>
      </tr>
      <% }) %>
      <% } else { %>
        <td class="px-2 first:pl-5 last:pr-5 py-3 whitespace-nowrap justify-center" colspan="7">
            <div class="text-center font-medium justify-center">Data tidak ada!</div>
        </td>
        <% } %>

    </tbody>
  </table>
</div>
</div>

<script>
  async function confirmDelete(operasionalId) {
    const result = await Swal.fire({
      title: "Apakah kamu yakin?",
      text: "Aksi ini tidak bisa dibatalkan!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonColor: "#3085d6",
      cancelButtonColor: "#d33",
      confirmButtonText: "Ya, hapus!",
      cancelButtonText: "Batal"
    });

    if (result.isConfirmed) {
      // Panggil route delete menggunakan fetch API
      try {
        const response = await fetch(`/operasional/${operasionalId}`, {
          method: 'DELETE'
        });

        if (response.ok) {
          Swal.fire("Berhasil!", "Operasional berhasil dihapus.", "success");
          // Tambahkan logika untuk refresh halaman atau redirect jika diperlukan
          setTimeout(() => {
            window.location.reload();
          }, 1500);
        } else {
          Swal.fire("Gagal!", "Terjadi kesalahan saat menghapus operasional.", "error");
        }
      } catch (error) {
        Swal.fire("Gagal!", "Terjadi kesalahan saat menghapus operasional.", "error");
      }
    }
  }
</script>